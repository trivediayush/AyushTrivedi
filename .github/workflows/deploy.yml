name: CI/CD Pipeline - Portfolio Website

on:
  push:
    branches:
      - master

jobs:
  # -------------------
  # Stage 1: Build
  # -------------------
  build:
    name: ğŸ—ï¸ Build
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Install dependencies (simulated)
        run: echo "Installing dependencies..."

      - name: Compile project (simulated)
        run: echo "Compiling website..."

      - name: List build files
        run: ls -l

  # -------------------
  # Stage 2: Parallel Tests
  # -------------------
  lint:
    name: ğŸ” Lint Check
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
      - name: Run linter (simulated)
        run: echo "Linting code... âœ…"

  html-validate:
    name: ğŸ“ HTML Validation
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
      - name: Validate HTML (simulated)
        run: echo "Validating HTML... âœ…"

  unit-tests:
    name: ğŸ§ª Unit Tests
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
      - name: Run unit tests (simulated)
        run: echo "All tests passed! âœ…"

  # -------------------
  # Stage 3: Deploy (waits for ALL tests)
  # -------------------
  deploy:
    name: ğŸš€ Deploy
    runs-on: ubuntu-latest
    needs: [lint, html-validate, unit-tests]
    permissions: 
      contents: write
      pages: write
      id-token: write
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
      - name: Prepare deployment
        run: echo "Preparing files for deployment..."
      - name: Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v4
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: .

  # -------------------
  # Stage 4: Notify
  # -------------------
  notify:
    name: ğŸ”” Notify
    runs-on: ubuntu-latest
    needs: deploy
    steps:
      - name: Send notification (simulated)
        run: echo "ğŸ‰ Deployment successful!"
